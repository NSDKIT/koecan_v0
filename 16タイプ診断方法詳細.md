# 16タイプ診断の診断方法詳細

## 概要

このシステムでは、**4つの軸**からなる16タイプのパーソナリティ診断を実施しています。学生（モニター）と企業の両方が同じ診断方法を使用します。

---

## 診断の4つの軸

### 1. 市場への関わり方（E ⇄ I）
- **E（外向型）**: 外部への発信と交流を重視
- **I（内向型）**: 内部の充実と深い思考を重視

### 2. 成長・戦略スタンス（N ⇄ S）
- **N（革新型）**: 挑戦と変化を好む
- **S（安定型）**: 安定と改善を重視

### 3. 組織運営スタンス（P ⇄ R）
- **P（人材志向）**: 仲間と成長を重視
- **R（成果志向）**: 目標達成を重視

### 4. 意思決定スタイル（F ⇄ O）
- **F（柔軟型）**: 自由な進め方を好む
- **O（規律型）**: 明確な手順を好む

---

## 学生（モニター）の診断方法

### ステップ1: 質問への回答

**4つのカテゴリー**で合計**28問**の質問に回答します：

1. **市場への関わり方（E vs I）**: 7問
2. **成長・戦略スタンス（N vs S）**: 7問
3. **組織運営スタンス（P vs R）**: 7問
4. **意思決定スタイル（F vs O）**: 7問

### ステップ2: 回答方法

各質問は**5段階のリッカート尺度**で回答します：

- **1**: 左側の選択肢に強く同意
- **2**: 左側の選択肢にやや同意
- **3**: どちらでもない（中立）
- **4**: 右側の選択肢にやや同意
- **5**: 右側の選択肢に強く同意

**例**: 
- 質問: 「外部との交流を大事にしている」 vs 「内部での結束を大事にしている」
- 1を選ぶ → 外部交流を強く重視（E寄り）
- 5を選ぶ → 内部結束を強く重視（I寄り）

### ステップ3: データ変換

回答値（UI値）をデータベース値に変換します：

| UI値 | DB値 | 意味 |
|------|------|------|
| 1 | -2 | 左側に強く傾いている |
| 2 | -1 | 左側にやや傾いている |
| 3 | 0 | 中立 |
| 4 | +1 | 右側にやや傾いている |
| 5 | +2 | 右側に強く傾いている |

**変換式**: `DB値 = UI値 - 3`

### ステップ4: スコア計算

各カテゴリーの**全質問のDB値を合計**します：

```javascript
// 例: 市場への関わり方（E vs I）
market_engagement_score = 
  q1のDB値 + q2のDB値 + q3のDB値 + q4のDB値 + 
  q5のDB値 + q6のDB値 + q7のDB値
```

### ステップ5: タイプ判定

各カテゴリーの合計スコアの**符号**でタイプを判定します：

| カテゴリー | スコア < 0 | スコア = 0 | スコア > 0 |
|-----------|-----------|-----------|-----------|
| 市場への関わり方 | **E** | **E/I** | **I** |
| 成長・戦略スタンス | **N** | **N/S** | **S** |
| 組織運営スタンス | **P** | **P/R** | **R** |
| 意思決定スタイル | **F** | **F/O** | **O** |

**判定ロジック**:
```javascript
if (market_engagement_score < 0) {
  typeCode += 'E';  // 外向型
} else if (market_engagement_score > 0) {
  typeCode += 'I';  // 内向型
} else {
  typeCode += 'E/I';  // 中間
}
```

### ステップ6: 16タイプの生成

4つの軸の判定結果を組み合わせて、**16タイプ**のいずれかを生成します：

**例**:
- E + N + P + F = **ENPF**
- I + S + R + O = **ISRO**
- E/I + N + P + F = **E/INPF**（中間タイプ）

**全16タイプ**:
- ENPF, ENPO, ENRF, ENRO
- ESPF, ESPO, ESRF, ESRO
- INPF, INPO, INRF, INRO
- ISPF, ISPO, ISRF, ISRO

---

## 企業の診断方法

企業の診断は、**従業員の回答をCSVでインポート**して実施します。

### ステップ1: CSVデータの準備

CSVファイルには、各従業員の以下の情報が必要です：

- **職種**（job_type）
- **勤続年数**（years_of_service）
- **各質問への回答**（1-5の値）

**質問の構造**:
- `market_engagement_q1` 〜 `market_engagement_q3`（3問）
- `growth_strategy_q1` 〜 `growth_strategy_q4`（4問）
- `organization_style_q1` 〜 `organization_style_q3`（3問）
- `decision_making_q1` 〜 `decision_making_q3`（3問）

**合計13問**（学生の28問とは異なる）

### ステップ2: 個人スコア計算

各従業員について、各カテゴリーのスコアを計算します：

```javascript
// 例: 市場への関わり方
marketEngagement = 
  market_engagement_q1 + market_engagement_q2 + market_engagement_q3;

// UI値（1-5）をDB値（-2〜+2）に変換
marketScore = (marketEngagement / 3) - 3;
```

### ステップ3: 企業全体のタイプ判定

**全従業員のスコアを平均**して、企業全体のタイプを判定します：

```javascript
// 全従業員のスコアを合計
total_market_engagement = 従業員1のスコア + 従業員2のスコア + ...;

// 平均を計算
avg_market_engagement = total_market_engagement / 従業員数;

// タイプ判定（学生と同じロジック）
if (avg_market_engagement < 0) {
  typeCode += 'E';
} else if (avg_market_engagement > 0) {
  typeCode += 'I';
} else {
  typeCode += 'E/I';
}
```

### ステップ4: 職種別・年代別の集計

企業の診断では、**職種別**と**年代別**の集計も行います：

1. **職種別集計**: 同じ職種の従業員のスコアを平均
2. **年代別集計**: 同じ勤続年数の従業員のスコアを平均

それぞれについて、同じロジックでタイプを判定します。

---

## スコアの意味

### スコアの範囲

各カテゴリーの合計スコアの範囲：

- **最小値**: -14（全7問で1を選択した場合）
- **最大値**: +14（全7問で5を選択した場合）

### スコアの解釈

| スコア範囲 | 解釈 |
|-----------|------|
| -14 〜 -7 | 左側のタイプに**強く傾いている** |
| -6 〜 -1 | 左側のタイプに**やや傾いている** |
| 0 | **中立**（両方の特性を持つ） |
| +1 〜 +6 | 右側のタイプに**やや傾いている** |
| +7 〜 +14 | 右側のタイプに**強く傾いている** |

---

## レーダーチャートでの表示

診断結果は、**8軸のレーダーチャート**で可視化されます：

### 8軸の構成

4つのカテゴリーを8軸に分解：

1. **E軸**: 外向型の傾向（0-100）
2. **I軸**: 内向型の傾向（0-100）
3. **N軸**: 革新型の傾向（0-100）
4. **S軸**: 安定型の傾向（0-100）
5. **P軸**: 人材志向の傾向（0-100）
6. **R軸**: 成果志向の傾向（0-100）
7. **F軸**: 柔軟型の傾向（0-100）
8. **O軸**: 規律型の傾向（0-100）

### スコアの正規化

各軸のスコアを0-100の範囲に正規化します：

```javascript
// スコアを0-100に変換
normalizeScore = (score) => {
  return Math.abs(score) * 50;  // -2→100, 0→0, +2→100
};
```

**例**:
- スコアが-2の場合 → E軸が100、I軸が0
- スコアが+1の場合 → E軸が0、I軸が50
- スコアが0の場合 → E軸が0、I軸が0

---

## 重要なポイント

### 1. スコアの符号が重要

- **マイナス** → 左側のタイプ（E, N, P, F）
- **プラス** → 右側のタイプ（I, S, R, O）
- **0** → 中間タイプ（例: E/I）

### 2. 絶対値は重要ではない

スコアの**符号**だけでタイプが決まります。絶対値の大きさは、レーダーチャートでの表示にのみ影響します。

### 3. 中間タイプの扱い

スコアが0の場合、タイプコードに「/」が含まれます（例: `E/ISRO`）。これは、両方の特性を持つことを示します。

### 4. 学生と企業の質問数の違い

- **学生**: 各カテゴリー7問 = 合計28問
- **企業**: 市場への関わり方3問、成長・戦略4問、組織運営3問、意思決定3問 = 合計13問

質問数が異なっても、**スコアの符号で判定**するため、診断方法は同じです。

---

## 診断の流れ（まとめ）

### 学生の場合

1. 4カテゴリー × 7問 = **28問**に回答
2. 各質問を1-5で回答（UI値）
3. UI値をDB値（-2〜+2）に変換
4. 各カテゴリーのDB値を合計
5. 合計の符号でタイプ判定
6. 4つの判定結果を組み合わせて16タイプを生成

### 企業の場合

1. CSVで従業員の回答をインポート
2. 各従業員のスコアを計算
3. 全従業員のスコアを平均
4. 平均の符号で企業全体のタイプ判定
5. 職種別・年代別も同様に集計

---

## 参考: コード内の実装箇所

- **学生の診断**: `components/MonitorDashboard.tsx` の `calculatePersonalityType` 関数
- **企業の診断**: `components/CompanyPersonalityImportModal.tsx` の `calculateType` 関数
- **質問定義**: `components/PersonalityAssessmentModal.tsx` の `categories` 配列

